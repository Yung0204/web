<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>分心追蹤表單</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f9f9f9;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: #0074d9;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        button {
            background-color: #0074d9;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px;
            cursor: pointer;
            border-radius: 5px;
        }
        button:hover {
            background-color: #0056a3;
        }
        input {
            padding: 5px;
            margin: 5px;
            width: 150px;
        }
        .form-container {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

<h1>分心追蹤表單</h1>

<!-- Input Form -->
<div class="form-container">
    <input type="date" id="dateInput" placeholder="日期">
    <input type="text" id="nameInput" placeholder="任務名稱">
    <input type="number" id="priorityInput" placeholder="優先級" min="1">
    <select id="completedInput">
        <option value="是">是</option>
        <option value="否">否</option>
    </select>
    <button id="addTask">新增任務</button>
</div>

<table id="taskTable">
    <thead>
        <tr>
            <th>日期</th>
            <th>任務名稱</th>
            <th>優先級</th>
            <th>是否完成</th>
            <th>分心次數</th>
            <th>分心來源</th>
            <th>分心總時間</th>
            <th>改進措施</th>
        </tr>
    </thead>
    <tbody>
        <!-- Rows will be dynamically added here -->
    </tbody>
</table>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const tableBody = document.querySelector("#taskTable tbody");
        const addTaskBtn = document.getElementById("addTask");

        // Load tasks from local storage or initialize
        const storedTasks = JSON.parse(localStorage.getItem("tasks")) || [];
        const tasks = [...storedTasks];

        // Populate table
        function populateTable() {
            tableBody.innerHTML = ""; // Clear existing rows
            tasks.forEach(task => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${task.date}</td>
                    <td>${task.name}</td>
                    <td>${task.priority}</td>
                    <td>${task.completed}</td>
                    <td>${task.distractions || ""}</td>
                    <td>${task.source || ""}</td>
                    <td>${task.time || ""}</td>
                    <td>${task.solution || ""}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Add a new task
        addTaskBtn.addEventListener("click", () => {
            const date = document.getElementById("dateInput").value;
            const name = document.getElementById("nameInput").value;
            const priority = document.getElementById("priorityInput").value;
            const completed = document.getElementById("completedInput").value;

            if (date && name && priority) {
                const newTask = {
                    date,
                    name,
                    priority: parseInt(priority, 10),
                    completed,
                    distractions: 0,
                    source: "",
                    time: "",
                    solution: ""
                };
                tasks.push(newTask);
                localStorage.setItem("tasks", JSON.stringify(tasks)); // Save to local storage
                populateTable();
                alert("任務新增成功！");
            } else {
                alert("請填寫完整的任務信息！");
            }
        });

        // Initialize table
        populateTable();
    });
</script>

</body>
</html>
